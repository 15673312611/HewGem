import{i as T,r as b,u as E,c as H,w as j,o as N,e as d,f as u,g as e,h as y,j as p,t as a,n as K,I as q,M as A,k as h,m as M,J as i,U as F,l as J,y as U,ad as L}from"./vendor-84cddc83.js";import{_ as G,b as O,r as v}from"./index-75d2a32e.js";const P={class:"min-h-screen bg-gradient-to-br from-gray-50 to-white py-10"},Q={class:"max-w-5xl mx-auto px-4 sm:px-6"},W={class:"bg-white rounded-2xl shadow-md border border-gray-100 mb-8 overflow-hidden"},X={class:"p-8 relative"},Y={class:"flex flex-col md:flex-row md:items-center gap-8 relative"},Z={class:"flex flex-col md:flex-row items-center gap-6"},ee={class:"w-20 h-20 rounded-full bg-gradient-to-tr from-blue-400 to-blue-500 flex items-center justify-center text-white shadow-md overflow-hidden"},te={class:"text-xl font-bold text-gray-800 md:text-left text-center"},se={class:"text-gray-500 mt-1 md:text-left text-center"},oe={class:"flex-1 flex flex-col md:flex-row items-center justify-end gap-6"},re={class:"flex items-center bg-blue-50 px-6 py-3 rounded-xl border border-blue-100"},ae={class:"font-bold text-xl text-blue-600"},le={class:"bg-white rounded-2xl shadow-md border border-gray-100 overflow-hidden"},ne={class:"overflow-x-auto custom-scrollbar"},ie={class:"min-w-full"},de={class:"divide-y divide-gray-100"},ue={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},ce={class:"px-6 py-4 whitespace-nowrap"},me={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},xe={key:0},ge={key:0,class:"py-4 px-6 bg-gray-50 border-t border-gray-100"},pe={class:"flex items-center justify-between"},fe={class:"text-sm text-gray-500"},be={class:"p-6"},ve={class:"mb-6"},ye={class:"flex items-center justify-between mb-2"},he={class:"text-2xl font-bold text-blue-600"},we={class:"bg-blue-50 rounded-xl p-4 border border-blue-100 mb-6"},_e={class:"flex"},ke={class:"text-sm text-gray-700"},Ce={class:"flex justify-end space-x-4 p-2"},Ve=["disabled"],je={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Me={__name:"UserCenter",setup(Ue){const r=T("userInfo"),c=b(!1),m=b(""),x=b(!1),g=b([]),I=E(),w=O(),B=H(()=>window.location.hostname==="ai.cutb.cn"),D=s=>{if(!s)return"";const t=new Date(s);return`${t.getMonth()+1}月${t.getDate()}日 ${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`},R=s=>s.status==="3"?"失败返还":s.type,S=s=>s.status==="3"?"bg-orange-50 text-orange-600 border border-orange-200":s.amount>0?"bg-green-50 text-green-600 border border-green-200":"bg-blue-50 text-blue-600 border border-blue-200",_=async()=>{try{const s=await v.get("/api/auth/check");if(s){if(r.value=s,w.setUser(s),!r.value.inviteCode){const t=await v.post("/api/user/generate-invite-code");t.code===200&&(r.value.inviteCode=t.data,w.setUser(r.value))}}else i({message:"获取用户信息失败",type:"error",customClass:"custom-message"})}catch(s){console.error("获取用户信息失败:",s),i({message:"获取用户信息失败",type:"error",customClass:"custom-message"})}},f=async()=>{var s,t,l;if((s=r.value)!=null&&s.id)try{const n=await v.get("/api/power/records",{params:{userId:r.value.id}});n.code===200?g.value=n.data:i({message:n.message||"获取使用记录失败",type:"error",customClass:"custom-message"})}catch(n){console.error("获取使用记录失败:",n),i({message:((l=(t=n.response)==null?void 0:t.data)==null?void 0:l.message)||"获取使用记录失败",type:"error",customClass:"custom-message"})}};j(()=>I.currentRoute.value,s=>{s.path==="/user-center"&&(_(),f())}),j(()=>{var s;return(s=r.value)==null?void 0:s.id},s=>{s&&f()}),N(()=>{var s;_(),(s=r.value)!=null&&s.id&&f()});const $=async()=>{var s,t;if(!m.value){i({message:"请输入充值卡密",type:"warning",customClass:"custom-message"});return}try{x.value=!0;const l=await v.post("/api/card/use",{userId:r.value.id,cardKey:m.value});l.code===200?(i({message:"充值成功",type:"success",customClass:"custom-message"}),c.value=!1,m.value="",await f(),window.location.reload()):i({message:l.message||"充值失败",type:"error",customClass:"custom-message"})}catch(l){console.error("充值失败:",l),i({message:((t=(s=l.response)==null?void 0:s.data)==null?void 0:t.message)||"充值失败",type:"error",customClass:"custom-message"})}finally{x.value=!1}};return(s,t)=>{var k,C,V;const l=L,n=F;return d(),u("div",P,[e("div",Q,[t[12]||(t[12]=e("div",{class:"flex items-center justify-between mb-10"},[e("h1",{class:"text-2xl sm:text-3xl font-bold text-gray-800"},"个人中心")],-1)),e("div",W,[e("div",X,[t[7]||(t[7]=e("div",{class:"absolute top-0 right-0 w-64 h-64 bg-blue-50 rounded-full -mt-20 -mr-20 opacity-50"},null,-1)),e("div",Y,[e("div",Z,[e("div",ee,[y(p(J),{class:"w-10 h-10"})]),e("div",null,[e("h2",te,a((k=p(r))==null?void 0:k.username),1),e("p",se,a((C=p(r))==null?void 0:C.email),1)])]),e("div",oe,[e("div",re,[t[5]||(t[5]=e("span",{class:"text-blue-500 text-xl mr-2"},"⚡",-1)),e("div",null,[t[4]||(t[4]=e("div",{class:"text-sm text-gray-500"},"当前算力",-1)),e("div",ae,a(((V=p(r))==null?void 0:V.power)||0),1)])]),e("button",{onClick:t[0]||(t[0]=o=>c.value=!0),class:"px-6 py-3 bg-gradient-to-r from-blue-400 to-blue-500 text-white rounded-xl font-medium hover:from-blue-500 hover:to-blue-600 transition-all shadow-md hover:shadow-lg flex items-center gap-2"},t[6]||(t[6]=[e("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),K(" 立即充值 ")]))])])])]),e("div",le,[t[11]||(t[11]=e("div",{class:"px-8 py-6 border-b border-gray-100"},[e("h3",{class:"text-lg font-bold text-gray-800"},"算力使用记录")],-1)),e("div",ne,[e("table",ie,[t[9]||(t[9]=e("thead",null,[e("tr",{class:"bg-gray-50 border-b border-gray-100"},[e("th",{class:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"时间"),e("th",{class:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"类型"),e("th",{class:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"算力变动"),e("th",{class:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"备注")])],-1)),e("tbody",de,[(d(!0),u(q,null,A(g.value,o=>(d(),u("tr",{key:o.id,class:"hover:bg-gray-50 transition-colors"},[e("td",ue,a(D(o.createTime)),1),e("td",ce,[e("span",{class:U(["px-2.5 py-1 text-xs font-medium rounded-full",S(o)])},a(R(o)),3)]),e("td",{class:U(["px-6 py-4 whitespace-nowrap text-sm font-medium",o.amount>0?"text-green-600":"text-blue-600"])},a(o.amount>0?"+":"")+a(o.amount),3),e("td",me,a(o.remark),1)]))),128)),g.value.length===0?(d(),u("tr",xe,t[8]||(t[8]=[e("td",{colspan:"4",class:"px-6 py-10 text-center text-gray-500"},[e("div",{class:"flex flex-col items-center"},[e("svg",{class:"w-12 h-12 text-gray-300 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),e("span",null,"暂无算力使用记录")])],-1)]))):h("",!0)])])]),g.value.length>0?(d(),u("div",ge,[e("div",pe,[e("div",fe," 共 "+a(g.value.length)+" 条记录 ",1),t[10]||(t[10]=e("div",{class:"flex items-center space-x-2 text-sm"},[e("button",{class:"px-3 py-1.5 rounded border border-gray-200 bg-white text-gray-600 hover:bg-gray-50 transition-colors"}," 上一页 "),e("span",{class:"px-3 py-1.5 rounded bg-blue-500 text-white"},"1"),e("button",{class:"px-3 py-1.5 rounded border border-gray-200 bg-white text-gray-600 hover:bg-gray-50 transition-colors"}," 下一页 ")],-1))])])):h("",!0)])]),y(n,{modelValue:c.value,"onUpdate:modelValue":t[3]||(t[3]=o=>c.value=o),title:"账户充值",width:"420px","close-on-click-modal":!1,class:"recharge-dialog"},{footer:M(()=>[e("div",Ce,[e("button",{onClick:t[2]||(t[2]=o=>c.value=!1),class:"px-4 py-2 bg-gray-100 rounded-lg font-medium text-gray-700 hover:bg-gray-200 transition-colors"}," 取消 "),e("button",{onClick:$,disabled:x.value,class:"px-5 py-2 bg-gradient-to-r from-blue-400 to-blue-500 text-white font-medium rounded-lg hover:from-blue-500 hover:to-blue-600 transition-all shadow-sm disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center min-w-[80px]"},[x.value?(d(),u("svg",je,t[17]||(t[17]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):h("",!0),e("span",null,a(x.value?"充值中...":"确认充值"),1)],8,Ve)])]),default:M(()=>{var o;return[e("div",be,[e("div",ve,[e("div",ye,[t[13]||(t[13]=e("p",{class:"text-gray-500"},"当前算力",-1)),e("p",he,a(((o=p(r))==null?void 0:o.power)||0),1)]),t[14]||(t[14]=e("div",{class:"w-full h-2 bg-gray-100 rounded-full overflow-hidden"},[e("div",{class:"h-full bg-gradient-to-r from-blue-300 to-blue-500 rounded-full",style:{width:"35%"}})],-1))]),e("div",we,[e("div",_e,[t[15]||(t[15]=e("svg",{class:"w-5 h-5 text-blue-500 mr-2 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",ke,a(B.value?"联系微信:soe303 购买卡密":"联系微信客服购买卡密"),1)])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"输入充值卡密",-1)),y(l,{modelValue:m.value,"onUpdate:modelValue":t[1]||(t[1]=z=>m.value=z),placeholder:"请输入充值卡密",maxlength:16,"show-word-limit":"",class:"custom-input"},null,8,["modelValue"])])])]}),_:1},8,["modelValue"])])}}},De=G(Me,[["__scopeId","data-v-59853592"]]);export{De as default};
