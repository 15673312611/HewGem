import{u as Y,r as v,c as ee,o as te,e as d,f as c,g as e,h as o,m as l,j as g,W as H,a7 as B,aq as L,ar as S,y as i,H as I,I as P,M as z,C as se,as as oe,t as x,n as E,at as re,k as _,v as le,s as q,Z as ie,_ as ae,U as ne,$ as de,ae as ue}from"./vendor-84cddc83.js";import{_ as ce,u as ve,r as G}from"./index-75d2a32e.js";const ge={class:"container mx-auto px-4 py-8"},pe={class:"bg-gradient-to-r from-blue-500 to-indigo-600 rounded-2xl p-6 mb-8 shadow-lg"},fe={class:"flex flex-col md:flex-row items-center justify-between gap-6"},me={class:"flex-1 text-center md:text-left"},xe={class:"flex flex-wrap gap-4"},he={class:"flex items-center text-sm text-blue-100"},ye={class:"flex items-center text-sm text-blue-100"},we={class:"flex items-center text-sm text-blue-100"},be={class:"flex-1 flex justify-center"},_e={class:"relative w-48 h-48"},ke={class:"absolute inset-0 flex items-center justify-center"},Ce={class:"grid grid-cols-2 gap-2"},je={class:"w-16 h-16 bg-white/20 rounded-lg flex items-center justify-center shadow-sm"},Be={class:"w-16 h-16 bg-white/20 rounded-lg flex items-center justify-center shadow-sm"},Ee={class:"w-16 h-16 bg-white/20 rounded-lg flex items-center justify-center shadow-sm"},Ve={class:"w-16 h-16 bg-white/20 rounded-lg flex items-center justify-center shadow-sm"},Ue={class:"bg-white rounded-xl shadow-sm p-6 mb-8"},De={class:"relative"},$e={class:"relative flex items-center space-x-2"},Fe={class:"relative flex items-center space-x-2"},Me={class:"relative flex items-center space-x-2"},Te=["onClick"],Ne={class:"relative flex items-center space-x-2"},He=["src","alt"],Le={class:"grid grid-cols-5 gap-4"},Se={class:"relative aspect-[16/12] bg-gray-100 overflow-hidden"},Ie=["src"],Pe={class:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300"},ze=["onClick"],qe={class:"p-2"},Ge={class:"flex items-center justify-between mb-0.5"},Oe={class:"text-sm font-medium text-gray-800 line-clamp-1 group-hover:text-primary transition-colors"},Re={key:0,class:"flex items-center justify-center w-5 h-5 rounded-full bg-blue-100"},We={key:1,class:"flex items-center justify-center w-5 h-5 rounded-full bg-pink-100"},Ze={class:"text-xs text-gray-500 mb-1 line-clamp-1"},Ae={class:"flex items-center justify-between"},Je={class:"text-xs text-gray-500"},Ke=["onClick"],Qe={class:"video-container"},Xe=["src"],Ye={key:0,class:"text-center py-20"},et={class:"text-gray-400 mb-4"},tt={class:"relative aspect-video bg-black rounded-lg overflow-hidden"},st=["src"],ot={class:"flex justify-end space-x-4"},rt={__name:"Market",setup(lt){const O=Y(),f=v([]),h=v([]),u=v(null),y=v(!1),a=v(null),V=v(!1),U=v(null),m=v(null),p=v(!1),k=v(!1),D=v(null),R=ve(),C=async()=>{var r;try{y.value=!0;const t={categoryId:(r=u.value)==null?void 0:r.id,gender:a.value},n=await G.get("/api/template/list",{params:t});f.value=n.map(w=>({...w,imageLoading:!0,imageError:!1}))}catch(t){console.error("获取形象列表失败:",t),f.value=[]}finally{y.value=!1}},W=async()=>{try{const r=await G.get("/api/template/categories");h.value=r.data||[]}catch(r){console.error("获取分类列表失败:",r),h.value=[]}},$=r=>{a.value=r,u.value=null,C()},F=r=>{var t;r===null?(u.value=null,a.value=null):((t=u.value)==null?void 0:t.id)===r.id?u.value=null:(u.value=r,a.value=null),C()},Z=r=>{ie.alert(`<div class="relative aspect-video bg-black rounded-lg overflow-hidden">
      <video 
        src="${r.videoUrl}" 
        class="w-full h-full"
        controls
        autoplay
      ></video>
    </div>`,"预览",{confirmButtonText:"使用",cancelButtonText:"关闭",showCancelButton:!0,dangerouslyUseHTMLString:!0,customClass:"preview-dialog",closeOnClickModal:!1,closeOnPressEscape:!1,showClose:!1,center:!0,width:"40%",callback:t=>{t==="confirm"&&j(r)}})},A=()=>{m.value&&(m.value.pause(),m.value.currentTime=0)},j=r=>{R.setCurrentDigitalHuman(r.id,r.videoUrl),O.push("/create")},J=r=>r?new Date(r).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}):"",K=ee(()=>h.value.length>5),Q=()=>{p.value=!p.value};return te(()=>{W(),C()}),(r,t)=>{const n=ae,w=ne,M=de,X=ue;return d(),c("div",ge,[e("div",pe,[e("div",fe,[e("div",me,[t[10]||(t[10]=e("h1",{class:"text-2xl font-bold text-white mb-3"},"形象市场",-1)),t[11]||(t[11]=e("p",{class:"text-blue-100 mb-4"},"选择您喜欢的形象，快速生成专业视频",-1)),e("div",xe,[e("div",he,[o(n,{class:"mr-2"},{default:l(()=>[o(g(H))]),_:1}),t[7]||(t[7]=e("span",null,"高清视频",-1))]),e("div",ye,[o(n,{class:"mr-2"},{default:l(()=>[o(g(B))]),_:1}),t[8]||(t[8]=e("span",null,"精选形象",-1))]),e("div",we,[o(n,{class:"mr-2"},{default:l(()=>[o(g(L))]),_:1}),t[9]||(t[9]=e("span",null,"快速生成",-1))])])]),e("div",be,[e("div",_e,[t[12]||(t[12]=e("div",{class:"absolute inset-0 bg-white/10 rounded-full animate-pulse"},null,-1)),e("div",ke,[e("div",Ce,[e("div",je,[o(n,{class:"w-8 h-8 text-white"},{default:l(()=>[o(g(H))]),_:1})]),e("div",Be,[o(n,{class:"w-8 h-8 text-white"},{default:l(()=>[o(g(B))]),_:1})]),e("div",Ee,[o(n,{class:"w-8 h-8 text-white"},{default:l(()=>[o(g(L))]),_:1})]),e("div",Ve,[o(n,{class:"w-8 h-8 text-white"},{default:l(()=>[o(g(S))]),_:1})])])])])])])]),e("div",Ue,[t[19]||(t[19]=e("div",{class:"flex items-center justify-between mb-6"},[e("h3",{class:"text-lg font-medium text-gray-900"},"选择分类")],-1)),e("div",De,[e("div",{class:i(["flex flex-wrap gap-6 pl-2 pt-2 pb-4",{"max-h-[66px]":!p.value,"overflow-hidden":!p.value}])},[e("button",{onClick:t[0]||(t[0]=s=>F(null)),class:i(["group relative overflow-hidden rounded-lg bg-gradient-to-br from-gray-50 to-white p-2 transition-all duration-300 hover:shadow-md",!u.value&&!a.value?"ring-2 ring-primary ring-offset-2":""])},[t[13]||(t[13]=e("div",{class:"absolute inset-0 bg-gradient-to-r from-primary/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"},null,-1)),e("div",$e,[e("div",{class:i(["w-8 h-8 rounded-lg flex items-center justify-center transition-all duration-300",!u.value&&!a.value?"bg-primary text-white shadow-lg shadow-primary/20":"bg-gray-100 text-gray-600 group-hover:bg-primary/10"])},[o(n,{class:"w-4 h-4"},{default:l(()=>[o(g(B))]),_:1})],2),e("span",{class:i(["text-xs font-medium transition-colors duration-300",!u.value&&!a.value?"text-primary":"text-gray-600 group-hover:text-primary"])}," 全部 ",2)])],2),e("button",{onClick:t[1]||(t[1]=s=>$(1)),class:i(["group relative overflow-hidden rounded-lg bg-gradient-to-br from-gray-50 to-white p-2 transition-all duration-300 hover:shadow-md",a.value===1?"ring-2 ring-primary ring-offset-2":""])},[t[15]||(t[15]=e("div",{class:"absolute inset-0 bg-gradient-to-r from-primary/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"},null,-1)),e("div",Fe,[e("div",{class:i(["w-8 h-8 rounded-lg flex items-center justify-center transition-all duration-300",a.value===1?"bg-primary text-white shadow-lg shadow-primary/20":"bg-gray-100 text-gray-600 group-hover:bg-primary/10"])},t[14]||(t[14]=[I('<svg width="14" height="14" viewBox="0 0 24 24" fill="none" data-v-6c587b97><circle cx="10" cy="14" r="5" stroke="#3B82F6" stroke-width="2" data-v-6c587b97></circle><line x1="14" y1="10" x2="21" y2="3" stroke="#3B82F6" stroke-width="2" data-v-6c587b97></line><line x1="18" y1="3" x2="21" y2="3" stroke="#3B82F6" stroke-width="2" data-v-6c587b97></line><line x1="21" y1="3" x2="21" y2="6" stroke="#3B82F6" stroke-width="2" data-v-6c587b97></line></svg>',1)]),2),e("span",{class:i(["text-xs font-medium transition-colors duration-300",a.value===1?"text-primary":"text-gray-600 group-hover:text-primary"])}," 男生 ",2)])],2),e("button",{onClick:t[2]||(t[2]=s=>$(2)),class:i(["group relative overflow-hidden rounded-lg bg-gradient-to-br from-gray-50 to-white p-2 transition-all duration-300 hover:shadow-md",a.value===2?"ring-2 ring-primary ring-offset-2":""])},[t[17]||(t[17]=e("div",{class:"absolute inset-0 bg-gradient-to-r from-primary/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"},null,-1)),e("div",Me,[e("div",{class:i(["w-8 h-8 rounded-lg flex items-center justify-center transition-all duration-300",a.value===2?"bg-primary text-white shadow-lg shadow-primary/20":"bg-gray-100 text-gray-600 group-hover:bg-primary/10"])},t[16]||(t[16]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none"},[e("circle",{cx:"12",cy:"10",r:"5",stroke:"#EC4899","stroke-width":"2"}),e("line",{x1:"12",y1:"15",x2:"12",y2:"21",stroke:"#EC4899","stroke-width":"2"}),e("line",{x1:"9",y1:"18",x2:"15",y2:"18",stroke:"#EC4899","stroke-width":"2"})],-1)]),2),e("span",{class:i(["text-xs font-medium transition-colors duration-300",a.value===2?"text-primary":"text-gray-600 group-hover:text-primary"])}," 女生 ",2)])],2),(d(!0),c(P,null,z(h.value,s=>{var b,T,N;return d(),c("button",{key:s.id,onClick:it=>F(s),class:i(["group relative overflow-hidden rounded-lg bg-gradient-to-br from-gray-50 to-white p-2 transition-all duration-300 hover:shadow-md",((b=u.value)==null?void 0:b.id)===s.id?"ring-2 ring-primary ring-offset-2":""])},[t[18]||(t[18]=e("div",{class:"absolute inset-0 bg-gradient-to-r from-primary/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"},null,-1)),e("div",Ne,[e("div",{class:i(["w-8 h-8 rounded-lg flex items-center justify-center transition-all duration-300",((T=u.value)==null?void 0:T.id)===s.id?"bg-primary text-white shadow-lg shadow-primary/20":"bg-gray-100 text-gray-600 group-hover:bg-primary/10"])},[s.iconUrl?(d(),c("img",{key:0,src:s.iconUrl,alt:s.name,class:"w-4 h-4 object-contain"},null,8,He)):(d(),se(n,{key:1,class:"w-4 h-4"},{default:l(()=>[o(g(oe))]),_:1}))],2),e("span",{class:i(["text-xs font-medium transition-colors duration-300",((N=u.value)==null?void 0:N.id)===s.id?"text-primary":"text-gray-600 group-hover:text-primary"])},x(s.name),3)])],10,Te)}),128))],2),K.value?(d(),c("button",{key:0,onClick:Q,class:"absolute right-0 bottom-0 bg-white px-3 py-1 text-xs text-primary hover:text-primary/80 transition-colors"},[E(x(p.value?"收起":"展开")+" ",1),o(n,{class:i(["ml-1",{"transform rotate-180":p.value}])},{default:l(()=>[o(g(re))]),_:1},8,["class"])])):_("",!0)])]),le((d(),c("div",Le,[(d(!0),c(P,null,z(f.value,s=>(d(),c("div",{key:s.id,class:"bg-white rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-all duration-300 group"},[e("div",Se,[e("img",{src:s.coverUrl,class:"w-full h-full object-cover object-[center_20%] transform group-hover:scale-105 transition-transform duration-300"},null,8,Ie),t[21]||(t[21]=e("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-300"},null,-1)),e("div",Pe,[e("button",{onClick:q(b=>Z(s),["stop"]),class:"w-12 h-12 rounded-full bg-white/90 hover:bg-white flex items-center justify-center transition-all duration-300 hover:scale-110"},t[20]||(t[20]=[e("div",{class:"w-0 h-0 border-t-[8px] border-t-transparent border-l-[12px] border-l-primary border-b-[8px] border-b-transparent ml-1"},null,-1)]),8,ze)])]),e("div",qe,[e("div",Ge,[e("h3",Oe,x(s.name),1),s.gender===1?(d(),c("div",Re,t[22]||(t[22]=[I('<svg width="14" height="14" viewBox="0 0 24 24" fill="none" data-v-6c587b97><circle cx="10" cy="14" r="5" stroke="#3B82F6" stroke-width="2" data-v-6c587b97></circle><line x1="14" y1="10" x2="21" y2="3" stroke="#3B82F6" stroke-width="2" data-v-6c587b97></line><line x1="18" y1="3" x2="21" y2="3" stroke="#3B82F6" stroke-width="2" data-v-6c587b97></line><line x1="21" y1="3" x2="21" y2="6" stroke="#3B82F6" stroke-width="2" data-v-6c587b97></line></svg>',1)]))):s.gender===2?(d(),c("div",We,t[23]||(t[23]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none"},[e("circle",{cx:"12",cy:"10",r:"5",stroke:"#EC4899","stroke-width":"2"}),e("line",{x1:"12",y1:"15",x2:"12",y2:"21",stroke:"#EC4899","stroke-width":"2"}),e("line",{x1:"9",y1:"18",x2:"15",y2:"18",stroke:"#EC4899","stroke-width":"2"})],-1)]))):_("",!0)]),e("p",Ze,x(s.description),1),e("div",Ae,[e("span",Je,x(J(s.createTime)),1),e("button",{onClick:q(b=>j(s),["stop"]),class:"px-2 py-1 bg-primary/10 text-primary text-xs rounded hover:bg-primary/20 transition-colors"}," 立即使用 ",8,Ke)])])]))),128))])),[[X,y.value]]),o(w,{modelValue:V.value,"onUpdate:modelValue":t[3]||(t[3]=s=>V.value=s),title:"视频预览",width:"800px","close-on-click-modal":!1,"close-on-press-escape":!0,class:"video-dialog",onClosed:A},{default:l(()=>[e("div",Qe,[U.value?(d(),c("video",{key:0,ref_key:"videoPlayer",ref:m,src:U.value,controls:"",class:"video-player",autoplay:""},null,8,Xe)):_("",!0)])]),_:1},8,["modelValue"]),!y.value&&(!f.value||f.value.length===0)?(d(),c("div",Ye,[e("div",et,[o(n,{size:48},{default:l(()=>[o(g(S))]),_:1})]),t[24]||(t[24]=e("p",{class:"text-gray-500"},"暂无形象数据",-1))])):_("",!0),o(w,{modelValue:k.value,"onUpdate:modelValue":t[6]||(t[6]=s=>k.value=s),title:"预览",width:"40%","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,class:"preview-dialog"},{footer:l(()=>[e("div",ot,[o(M,{onClick:t[4]||(t[4]=s=>j(D.value))},{default:l(()=>t[25]||(t[25]=[E("使用")])),_:1}),o(M,{type:"primary",onClick:t[5]||(t[5]=s=>k.value=!1)},{default:l(()=>t[26]||(t[26]=[E("关闭")])),_:1})])]),default:l(()=>{var s;return[e("div",tt,[e("video",{ref_key:"videoPlayer",ref:m,src:(s=D.value)==null?void 0:s.videoUrl,class:"w-full h-full",controls:"",autoplay:""},null,8,st)])]}),_:1},8,["modelValue"])])}}},dt=ce(rt,[["__scopeId","data-v-6c587b97"]]);export{dt as default};
